{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/davidondrich/dev/advocacy-maps/pages/advocacy-maps.js\";\nimport { Fragment } from \"react\";\nimport { Layout } from \"../components\";\nimport { MapContainer, TileLayer, Marker, Popup } from \"react-leaflet\";\nimport Papa from \"papaparse\";\nimport styles from \"../styles/Map.module.css\";\n/* Templates for map elements */\n\nconst districtLegend = () => /*#__PURE__*/_jsxDEV(Fragment, {\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"legend__item legend__item--committed\",\n    children: \"Committed to Vote\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"legend__item legend__item--join\",\n    children: \"Join District Team\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 12,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 10,\n  columnNumber: 3\n}, this);\n\nconst districtStyle = rep => ({\n  className: `district district--${rep.commitments ? \"committed\" : \"join\"}`\n});\n\nconst repCommitments = rep => rep.commitments ? /*#__PURE__*/_jsxDEV(\"p\", {\n  children: /*#__PURE__*/_jsxDEV(\"table\", {\n    children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n      children: /*#__PURE__*/_jsxDEV(\"th\", {\n        colspan: \"2\",\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Committed to vote for:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 26,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n        class: \"commitment\",\n        children: [\"$\", rep.committee_votes ? \"✓\" : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: \"Committee votes made public\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n        class: \"commitment\",\n        children: [\"$\", rep.public_bills ? \"✓\" : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: \"Bills made public for 72 hours\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n        class: \"commitment\",\n        children: [\"$\", rep.roll_call ? \"✓\" : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: \"Lower threshold for public roll call\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 23,\n    columnNumber: 7\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 22,\n  columnNumber: 5\n}, this) : \"\";\n\nconst callToAction = rep => /*#__PURE__*/_jsxDEV(\"a\", {\n  href: \"https://actonmass.org/the-campaign/?your_state_representative=${rep.first_name} ${rep.last_name}#join-your-district-team\",\n  target: \"_parent\",\n  children: /*#__PURE__*/_jsxDEV(\"strong\", {\n    children: [\"Join $\", rep.commitments ? \"the Campaign\" : \"District Team\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 48,\n  columnNumber: 3\n}, this);\n\nconst districtPopup = rep => `\n\t<p>\n\t\t<strong>${rep.first_name} ${rep.last_name}</strong>\n\t\t${rep.url ? `(<a href=\"${rep.url}\">contact</a>)` : \"\"}\n\t\t<br />${rep.party ? `${rep.party},` : \"\"}\n\t\t${rep.district}\n\t\t${rep.elect ? \"(Elect)\" : \"\"}\n\t</p>\n\t${repCommitments(rep)}\n\t${callToAction(rep)}\n`;\n\nconst onPopup = e => {\n  const active = e.type === \"popupopen\";\n  e.target.getElement().classList.toggle(\"district--active\", active);\n};\n\nconst renderMap = () => {\n  Promise.all([fetch(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\").then(response => response.text()).then(csv => {\n    const parsed = Papa.parse(csv, {\n      header: true,\n      dynamicTyping: true\n    });\n    return Promise.resolve(parsed.data);\n  }), fetch(\"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\").then(response => response.json())]).then(([supporters, houseFeatures]) => {\n    const supportersByDistrict = supporters.reduce((acc, cur) => {\n      acc[cur.district] = cur;\n      return acc;\n    }, {});\n\n    function repProperties(feature) {\n      const supporter = supportersByDistrict[feature.properties.district];\n      return supporter;\n    }\n    /* Build the map */\n\n\n    const houseLayer = L.geoJson(houseFeatures, {\n      style: feature => districtStyle(repProperties(feature)),\n      onEachFeature: (feature, layer) => {\n        const rep = repProperties(feature);\n        layer.bindPopup(districtPopup(rep));\n        layer.on(\"popupopen\", onPopup);\n        layer.on(\"popupclose\", onPopup);\n        feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n      }\n    });\n    const searchControl = new L.Control.Search({\n      layer: houseLayer,\n      propertyName: \"index\",\n      initial: false,\n      marker: false,\n      textPlaceholder: \"Search reps and districts\",\n\n      moveToLocation(latlng, title, map) {\n        map.fitBounds(latlng.layer.getBounds());\n        latlng.layer.openPopup();\n      }\n\n    });\n    const legendControl = L.control({\n      position: \"topright\"\n    });\n\n    legendControl.onAdd = () => {\n      const div = L.DomUtil.create(\"div\", \"legend\");\n      div.innerHTML = districtLegend();\n      return div;\n    };\n\n    const map = L.map(\"map\").addLayer(L.tileLayer.provider(\"CartoDB.Positron\")).addLayer(houseLayer).addControl(searchControl).addControl(legendControl).fitBounds(houseLayer.getBounds()); // Avoid accidental excessive zoom out\n\n    map.setMinZoom(map.getZoom());\n  });\n};\n\nfunction AdvocacyMap() {\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [51.505, -0.09],\n      zoom: 13,\n      scrollWheelZoom: false,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Marker, {\n        position: [51.505, -0.09],\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: [\"A pretty CSS3 popup. \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 34\n          }, this), \" Easily customizable.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 5\n  }, this);\n}\n\n_c = AdvocacyMap;\nexport default AdvocacyMap;\n\nvar _c;\n\n$RefreshReg$(_c, \"AdvocacyMap\");","map":{"version":3,"sources":["/Users/davidondrich/dev/advocacy-maps/pages/advocacy-maps.js"],"names":["Fragment","Layout","MapContainer","TileLayer","Marker","Popup","Papa","styles","districtLegend","districtStyle","rep","className","commitments","repCommitments","committee_votes","public_bills","roll_call","callToAction","districtPopup","first_name","last_name","url","party","district","elect","onPopup","e","active","type","target","getElement","classList","toggle","renderMap","Promise","all","fetch","then","response","text","csv","parsed","parse","header","dynamicTyping","resolve","data","json","supporters","houseFeatures","supportersByDistrict","reduce","acc","cur","repProperties","feature","supporter","properties","houseLayer","L","geoJson","style","onEachFeature","layer","bindPopup","on","index","searchControl","Control","Search","propertyName","initial","marker","textPlaceholder","moveToLocation","latlng","title","map","fitBounds","getBounds","openPopup","legendControl","control","position","onAdd","div","DomUtil","create","innerHTML","addLayer","tileLayer","provider","addControl","setMinZoom","getZoom","AdvocacyMap"],"mappings":"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","sourcesContent":["import { Fragment } from \"react\";\nimport { Layout } from \"../components\";\nimport { MapContainer, TileLayer, Marker, Popup } from \"react-leaflet\";\nimport Papa from \"papaparse\";\nimport styles from \"../styles/Map.module.css\";\n\n/* Templates for map elements */\n\nconst districtLegend = () => (\n  <Fragment>\n    <div class=\"legend__item legend__item--committed\">Committed to Vote</div>\n    <div class=\"legend__item legend__item--join\">Join District Team</div>\n  </Fragment>\n);\n\nconst districtStyle = (rep) => ({\n  className: `district district--${rep.commitments ? \"committed\" : \"join\"}`,\n});\n\nconst repCommitments = (rep) =>\n  rep.commitments ? (\n    <p>\n      <table>\n        <tr>\n          <th colspan=\"2\">\n            <strong>Committed to vote for:</strong>\n          </th>\n        </tr>\n        <tr>\n          <td class=\"commitment\">${rep.committee_votes ? \"✓\" : \"\"}</td>\n          <td>Committee votes made public</td>\n        </tr>\n        <tr>\n          <td class=\"commitment\">${rep.public_bills ? \"✓\" : \"\"}</td>\n          <td>Bills made public for 72 hours</td>\n        </tr>\n        <tr>\n          <td class=\"commitment\">${rep.roll_call ? \"✓\" : \"\"}</td>\n          <td>Lower threshold for public roll call</td>\n        </tr>\n      </table>\n    </p>\n  ) : (\n    \"\"\n  );\n\nconst callToAction = (rep) => (\n  <a\n    href=\"https://actonmass.org/the-campaign/?your_state_representative=${rep.first_name} ${rep.last_name}#join-your-district-team\"\n    target=\"_parent\"\n  >\n    <strong>Join ${rep.commitments ? \"the Campaign\" : \"District Team\"}</strong>\n  </a>\n);\n\nconst districtPopup = (rep) => `\n\t<p>\n\t\t<strong>${rep.first_name} ${rep.last_name}</strong>\n\t\t${rep.url ? `(<a href=\"${rep.url}\">contact</a>)` : \"\"}\n\t\t<br />${rep.party ? `${rep.party},` : \"\"}\n\t\t${rep.district}\n\t\t${rep.elect ? \"(Elect)\" : \"\"}\n\t</p>\n\t${repCommitments(rep)}\n\t${callToAction(rep)}\n`;\n\nconst onPopup = (e) => {\n  const active = e.type === \"popupopen\";\n  e.target.getElement().classList.toggle(\"district--active\", active);\n};\n\nconst renderMap = () => {\n  Promise.all([\n    fetch(\n      \"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\"\n    )\n      .then((response) => response.text())\n      .then((csv) => {\n        const parsed = Papa.parse(csv, { header: true, dynamicTyping: true });\n        return Promise.resolve(parsed.data);\n      }),\n    fetch(\n      \"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\"\n    ).then((response) => response.json()),\n  ]).then(([supporters, houseFeatures]) => {\n    const supportersByDistrict = supporters.reduce((acc, cur) => {\n      acc[cur.district] = cur;\n      return acc;\n    }, {});\n\n    function repProperties(feature) {\n      const supporter = supportersByDistrict[feature.properties.district];\n      return supporter;\n    }\n\n    /* Build the map */\n\n    const houseLayer = L.geoJson(houseFeatures, {\n      style: (feature) => districtStyle(repProperties(feature)),\n      onEachFeature: (feature, layer) => {\n        const rep = repProperties(feature);\n        layer.bindPopup(districtPopup(rep));\n        layer.on(\"popupopen\", onPopup);\n        layer.on(\"popupclose\", onPopup);\n        feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n      },\n    });\n\n    const searchControl = new L.Control.Search({\n      layer: houseLayer,\n      propertyName: \"index\",\n      initial: false,\n      marker: false,\n      textPlaceholder: \"Search reps and districts\",\n      moveToLocation(latlng, title, map) {\n        map.fitBounds(latlng.layer.getBounds());\n        latlng.layer.openPopup();\n      },\n    });\n\n    const legendControl = L.control({ position: \"topright\" });\n    legendControl.onAdd = () => {\n      const div = L.DomUtil.create(\"div\", \"legend\");\n      div.innerHTML = districtLegend();\n      return div;\n    };\n\n    const map = L.map(\"map\")\n      .addLayer(L.tileLayer.provider(\"CartoDB.Positron\"))\n      .addLayer(houseLayer)\n      .addControl(searchControl)\n      .addControl(legendControl)\n      .fitBounds(houseLayer.getBounds());\n\n    // Avoid accidental excessive zoom out\n    map.setMinZoom(map.getZoom());\n  });\n};\n\nfunction AdvocacyMap() {\n  return (\n    <Layout>\n      <MapContainer center={[51.505, -0.09]} zoom={13} scrollWheelZoom={false}>\n        <TileLayer\n          attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        <Marker position={[51.505, -0.09]}>\n          <Popup>\n            A pretty CSS3 popup. <br /> Easily customizable.\n          </Popup>\n        </Marker>\n      </MapContainer>\n    </Layout>\n  );\n}\n\nexport default AdvocacyMap;\n"]},"metadata":{},"sourceType":"module"}