{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/davidondrich/dev/advocacy-maps/components/Map/Map.jsx\";\nimport React, { useEffect } from \"react\";\nimport Papa from \"papaparse\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"leaflet-defaulticon-compatibility/dist/leaflet-defaulticon-compatibility.css\";\nimport \"leaflet-defaulticon-compatibility\";\n\nconst districtStyle = rep => ({\n  className: `district district--${rep.commitments ? \"committed\" : \"join\"}`\n});\n/*\nconst renderMap = () => {\n  Promise.all([\n    fetch(\n      \"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\"\n    )\n      .then((response) => response.text())\n      .then((csv) => {\n        const parsed = Papa.parse(csv, { header: true, dynamicTyping: true });\n        return Promise.resolve(parsed.data);\n      }),\n    fetch(\n      \"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\"\n    ).then((response) => response.json()),\n  ]).then(([supporters, houseFeatures]) => {\n    const supportersByDistrict = supporters.reduce((acc, cur) => {\n      acc[cur.district] = cur;\n      return acc;\n    }, {});\n\n    console.log(\"Supports\", supportersByDistrict);\n    console.log(\"HOUSE\", houseFeatures);\n    houseFeaturesGeoJsonData = houseFeatures;\n\n    function repProperties(feature) {\n      const supporter = supportersByDistrict[feature.properties.district];\n      return supporter;\n    }\n\n    const houseLayer = L.geoJson(houseFeatures, {\n      style: (feature) => districtStyle(repProperties(feature)),\n      onEachFeature: (feature, layer) => {\n        const rep = repProperties(feature);\n        layer.bindPopup(districtPopup(rep));\n        layer.on(\"popupopen\", onPopup);\n        layer.on(\"popupclose\", onPopup);\n        feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n      },\n    });\n\n    const searchControl = new L.Control.Search({\n      layer: houseLayer,\n      propertyName: \"index\",\n      initial: false,\n      marker: false,\n      textPlaceholder: \"Search reps and districts\",\n      moveToLocation(latlng, title, map) {\n        map.fitBounds(latlng.layer.getBounds());\n        latlng.layer.openPopup();\n      },\n    });\n\n    const legendControl = L.control({ position: \"topright\" });\n    legendControl.onAdd = () => {\n      const div = L.DomUtil.create(\"div\", \"legend\");\n      div.innerHTML = districtLegend();\n      return div;\n    };\n\n    const map = L.map(\"map\")\n      .addLayer(L.tileLayer.provider(\"CartoDB.Positron\"))\n      .addLayer(houseLayer)\n      .addControl(searchControl)\n      .addControl(legendControl)\n      .fitBounds(houseLayer.getBounds());\n\n    // Avoid accidental excessive zoom out\n    map.setMinZoom(map.getZoom());\n  });\n};\n\t\t*/\n\n\nimport { Component } from \"react\";\nimport L from \"leaflet\";\n\nclass Map extends Component {\n  componentDidMount() {\n    Promise.all([fetch(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\").then(response => response.text()).then(csv => {\n      const parsed = Papa.parse(csv, {\n        header: true,\n        dynamicTyping: true\n      });\n      return Promise.resolve(parsed.data);\n    }), fetch(\"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\").then(response => response.json())]).then(([supporters, houseFeatures]) => {\n      const supportersByDistrict = supporters.reduce((acc, cur) => {\n        acc[cur.district] = cur;\n        return acc;\n      }, {});\n      console.log(\"Supports\", supportersByDistrict);\n      console.log(\"HOUSE\", houseFeatures);\n\n      function repProperties(feature) {\n        const supporter = supportersByDistrict[feature.properties.district];\n        return supporter;\n      }\n\n      const houseLayer = L.geoJson(houseFeatures, {\n        style: feature => districtStyle(repProperties(feature)),\n        onEachFeature: (feature, layer) => {\n          const rep = repProperties(feature);\n          layer.bindPopup(districtPopup(rep));\n          layer.on(\"popupopen\", onPopup);\n          layer.on(\"popupclose\", onPopup);\n          feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n        }\n      });\n      const searchControl = new L.Control.Search({\n        layer: houseLayer,\n        propertyName: \"index\",\n        initial: false,\n        marker: false,\n        textPlaceholder: \"Search reps and districts\",\n\n        moveToLocation(latlng, title, map) {\n          map.fitBounds(latlng.layer.getBounds());\n          latlng.layer.openPopup();\n        }\n\n      });\n      const legendControl = L.control({\n        position: \"topright\"\n      });\n\n      legendControl.onAdd = () => {\n        const div = L.DomUtil.create(\"div\", \"legend\");\n        div.innerHTML = districtLegend();\n        return div;\n      };\n\n      this.map = L.map(\"map\").addLayer(L.tileLayer.provider(\"CartoDB.Positron\")).addLayer(houseLayer).addControl(searchControl).addControl(legendControl).fitBounds(houseLayer.getBounds()); // Avoid accidental excessive zoom out\n\n      map.setMinZoom(map.getZoom());\n    }); // create map\n\n    this.map = L.map(\"map\", {\n      center: [49.8419, 24.0315],\n      zoom: 16,\n      layers: [L.tileLayer(\"http://{s}.tile.osm.org/{z}/{x}/{y}.png\", {\n        attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n      })]\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"map\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 12\n    }, this);\n  }\n\n}\n\nexport default Map;","map":{"version":3,"sources":["/Users/davidondrich/dev/advocacy-maps/components/Map/Map.jsx"],"names":["React","useEffect","Papa","districtStyle","rep","className","commitments","Component","L","Map","componentDidMount","Promise","all","fetch","then","response","text","csv","parsed","parse","header","dynamicTyping","resolve","data","json","supporters","houseFeatures","supportersByDistrict","reduce","acc","cur","district","console","log","repProperties","feature","supporter","properties","houseLayer","geoJson","style","onEachFeature","layer","bindPopup","districtPopup","on","onPopup","index","first_name","last_name","searchControl","Control","Search","propertyName","initial","marker","textPlaceholder","moveToLocation","latlng","title","map","fitBounds","getBounds","openPopup","legendControl","control","position","onAdd","div","DomUtil","create","innerHTML","districtLegend","addLayer","tileLayer","provider","addControl","setMinZoom","getZoom","center","zoom","layers","attribution","render"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport Papa from \"papaparse\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"leaflet-defaulticon-compatibility/dist/leaflet-defaulticon-compatibility.css\";\nimport \"leaflet-defaulticon-compatibility\";\n\nconst districtStyle = (rep) => ({\n  className: `district district--${rep.commitments ? \"committed\" : \"join\"}`,\n});\n\n/*\nconst renderMap = () => {\n  Promise.all([\n    fetch(\n      \"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\"\n    )\n      .then((response) => response.text())\n      .then((csv) => {\n        const parsed = Papa.parse(csv, { header: true, dynamicTyping: true });\n        return Promise.resolve(parsed.data);\n      }),\n    fetch(\n      \"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\"\n    ).then((response) => response.json()),\n  ]).then(([supporters, houseFeatures]) => {\n    const supportersByDistrict = supporters.reduce((acc, cur) => {\n      acc[cur.district] = cur;\n      return acc;\n    }, {});\n\n    console.log(\"Supports\", supportersByDistrict);\n    console.log(\"HOUSE\", houseFeatures);\n    houseFeaturesGeoJsonData = houseFeatures;\n\n    function repProperties(feature) {\n      const supporter = supportersByDistrict[feature.properties.district];\n      return supporter;\n    }\n\n    const houseLayer = L.geoJson(houseFeatures, {\n      style: (feature) => districtStyle(repProperties(feature)),\n      onEachFeature: (feature, layer) => {\n        const rep = repProperties(feature);\n        layer.bindPopup(districtPopup(rep));\n        layer.on(\"popupopen\", onPopup);\n        layer.on(\"popupclose\", onPopup);\n        feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n      },\n    });\n\n    const searchControl = new L.Control.Search({\n      layer: houseLayer,\n      propertyName: \"index\",\n      initial: false,\n      marker: false,\n      textPlaceholder: \"Search reps and districts\",\n      moveToLocation(latlng, title, map) {\n        map.fitBounds(latlng.layer.getBounds());\n        latlng.layer.openPopup();\n      },\n    });\n\n    const legendControl = L.control({ position: \"topright\" });\n    legendControl.onAdd = () => {\n      const div = L.DomUtil.create(\"div\", \"legend\");\n      div.innerHTML = districtLegend();\n      return div;\n    };\n\n    const map = L.map(\"map\")\n      .addLayer(L.tileLayer.provider(\"CartoDB.Positron\"))\n      .addLayer(houseLayer)\n      .addControl(searchControl)\n      .addControl(legendControl)\n      .fitBounds(houseLayer.getBounds());\n\n    // Avoid accidental excessive zoom out\n    map.setMinZoom(map.getZoom());\n  });\n};\n\t\t*/\n\nimport { Component } from \"react\";\nimport L from \"leaflet\";\n\nclass Map extends Component {\n  componentDidMount() {\n    Promise.all([\n      fetch(\n        \"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\"\n      )\n        .then((response) => response.text())\n        .then((csv) => {\n          const parsed = Papa.parse(csv, { header: true, dynamicTyping: true });\n          return Promise.resolve(parsed.data);\n        }),\n      fetch(\n        \"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\"\n      ).then((response) => response.json()),\n    ]).then(([supporters, houseFeatures]) => {\n      const supportersByDistrict = supporters.reduce((acc, cur) => {\n        acc[cur.district] = cur;\n        return acc;\n      }, {});\n\n      console.log(\"Supports\", supportersByDistrict);\n      console.log(\"HOUSE\", houseFeatures);\n\n      function repProperties(feature) {\n        const supporter = supportersByDistrict[feature.properties.district];\n        return supporter;\n      }\n\n      const houseLayer = L.geoJson(houseFeatures, {\n        style: (feature) => districtStyle(repProperties(feature)),\n        onEachFeature: (feature, layer) => {\n          const rep = repProperties(feature);\n          layer.bindPopup(districtPopup(rep));\n          layer.on(\"popupopen\", onPopup);\n          layer.on(\"popupclose\", onPopup);\n          feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n        },\n      });\n\n      const searchControl = new L.Control.Search({\n        layer: houseLayer,\n        propertyName: \"index\",\n        initial: false,\n        marker: false,\n        textPlaceholder: \"Search reps and districts\",\n        moveToLocation(latlng, title, map) {\n          map.fitBounds(latlng.layer.getBounds());\n          latlng.layer.openPopup();\n        },\n      });\n\n      const legendControl = L.control({ position: \"topright\" });\n      legendControl.onAdd = () => {\n        const div = L.DomUtil.create(\"div\", \"legend\");\n        div.innerHTML = districtLegend();\n        return div;\n      };\n\n      this.map = L.map(\"map\")\n        .addLayer(L.tileLayer.provider(\"CartoDB.Positron\"))\n        .addLayer(houseLayer)\n        .addControl(searchControl)\n        .addControl(legendControl)\n        .fitBounds(houseLayer.getBounds());\n\n      // Avoid accidental excessive zoom out\n      map.setMinZoom(map.getZoom());\n    });\n\n    // create map\n    this.map = L.map(\"map\", {\n      center: [49.8419, 24.0315],\n      zoom: 16,\n      layers: [\n        L.tileLayer(\"http://{s}.tile.osm.org/{z}/{x}/{y}.png\", {\n          attribution:\n            '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\n        }),\n      ],\n    });\n  }\n\n  render() {\n    return <div id=\"map\"></div>;\n  }\n}\n\nexport default Map;\n"]},"metadata":{},"sourceType":"module"}