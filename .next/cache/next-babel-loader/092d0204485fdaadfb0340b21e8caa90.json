{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/davidondrich/dev/advocacy-maps/components/Map/Map.jsx\";\nimport React, { useEffect } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup, GeoJSON } from \"react-leaflet\";\nimport Papa from \"papaparse\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"leaflet-defaulticon-compatibility/dist/leaflet-defaulticon-compatibility.css\";\nimport \"leaflet-defaulticon-compatibility\";\n\nconst districtStyle = rep => ({\n  className: `district district--${rep.commitments ? \"committed\" : \"join\"}`\n});\n\nconst renderMap = () => {\n  Promise.all([fetch(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\").then(response => response.text()).then(csv => {\n    const parsed = Papa.parse(csv, {\n      header: true,\n      dynamicTyping: true\n    });\n    return Promise.resolve(parsed.data);\n  }), fetch(\"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\").then(response => response.json())]).then(([supporters, houseFeatures]) => {\n    const supportersByDistrict = supporters.reduce((acc, cur) => {\n      acc[cur.district] = cur;\n      return acc;\n    }, {});\n    console.log(\"Supports\", supportersByDistrict);\n    console.log(\"HOUSE\", houseFeatures);\n\n    function repProperties(feature) {\n      const supporter = supportersByDistrict[feature.properties.district];\n      return supporter;\n    }\n\n    const houseLayer = L.geoJson(houseFeatures, {\n      style: feature => districtStyle(repProperties(feature)),\n      onEachFeature: (feature, layer) => {\n        const rep = repProperties(feature);\n        layer.bindPopup(districtPopup(rep));\n        layer.on(\"popupopen\", onPopup);\n        layer.on(\"popupclose\", onPopup);\n        feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n      }\n    });\n    /*\n     const searchControl = new L.Control.Search({\n      layer: houseLayer,\n      propertyName: \"index\",\n      initial: false,\n      marker: false,\n      textPlaceholder: \"Search reps and districts\",\n      moveToLocation(latlng, title, map) {\n        map.fitBounds(latlng.layer.getBounds());\n        latlng.layer.openPopup();\n      },\n    });\n     const legendControl = L.control({ position: \"topright\" });\n    legendControl.onAdd = () => {\n      const div = L.DomUtil.create(\"div\", \"legend\");\n      div.innerHTML = districtLegend();\n      return div;\n    };\n     const map = L.map(\"map\")\n      .addLayer(L.tileLayer.provider(\"CartoDB.Positron\"))\n      .addLayer(houseLayer)\n      .addControl(searchControl)\n      .addControl(legendControl)\n      .fitBounds(houseLayer.getBounds());\n     // Avoid accidental excessive zoom out\n    map.setMinZoom(map.getZoom());\n    */\n  });\n};\n\nconst Map = () => {\n  useEffect(() => {\n    renderMap();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(MapContainer, {\n    center: [40.8054, -74.0241],\n    zoom: 14,\n    scrollWheelZoom: false,\n    style: {\n      height: \"50vh\",\n      width: \"100%\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n      url: \"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png\",\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, &copy; <a href=\"http://cartodb.com/attributions\">CartoDB</a>'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(GeoJSON, {\n      data: this.props.map.data.json\n    }, keyFunction(this.props.map.data.json), false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Marker, {\n      position: [40.8054, -74.0241],\n      draggable: true,\n      animate: true,\n      children: /*#__PURE__*/_jsxDEV(Popup, {\n        children: \"Hey ! I live here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n};\n\nexport default Map;","map":{"version":3,"sources":["/Users/davidondrich/dev/advocacy-maps/components/Map/Map.jsx"],"names":["React","useEffect","MapContainer","TileLayer","Marker","Popup","GeoJSON","Papa","districtStyle","rep","className","commitments","renderMap","Promise","all","fetch","then","response","text","csv","parsed","parse","header","dynamicTyping","resolve","data","json","supporters","houseFeatures","supportersByDistrict","reduce","acc","cur","district","console","log","repProperties","feature","supporter","properties","houseLayer","L","geoJson","style","onEachFeature","layer","bindPopup","districtPopup","on","onPopup","index","first_name","last_name","Map","height","width","props","map","keyFunction"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup, GeoJSON } from \"react-leaflet\";\nimport Papa from \"papaparse\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"leaflet-defaulticon-compatibility/dist/leaflet-defaulticon-compatibility.css\";\nimport \"leaflet-defaulticon-compatibility\";\n\nconst districtStyle = (rep) => ({\n  className: `district district--${rep.commitments ? \"committed\" : \"join\"}`,\n});\n\nconst renderMap = () => {\n  Promise.all([\n    fetch(\n      \"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4l7bRcBIgwsEPGM_s9zF9csIeTgE2No_4tA6MuDCBUbfmWY_e9mAfzPpCJTsIK_hUzOyJ8CmdGMsX/pub?gid=641305740&single=true&output=csv\"\n    )\n      .then((response) => response.text())\n      .then((csv) => {\n        const parsed = Papa.parse(csv, { header: true, dynamicTyping: true });\n        return Promise.resolve(parsed.data);\n      }),\n    fetch(\n      \"https://raw.githubusercontent.com/bhrutledge/ma-legislature/main/dist/ma_house.geojson\"\n    ).then((response) => response.json()),\n  ]).then(([supporters, houseFeatures]) => {\n    const supportersByDistrict = supporters.reduce((acc, cur) => {\n      acc[cur.district] = cur;\n      return acc;\n    }, {});\n\n    console.log(\"Supports\", supportersByDistrict);\n    console.log(\"HOUSE\", houseFeatures);\n\n    function repProperties(feature) {\n      const supporter = supportersByDistrict[feature.properties.district];\n      return supporter;\n    }\n\n    const houseLayer = L.geoJson(houseFeatures, {\n      style: (feature) => districtStyle(repProperties(feature)),\n      onEachFeature: (feature, layer) => {\n        const rep = repProperties(feature);\n        layer.bindPopup(districtPopup(rep));\n        layer.on(\"popupopen\", onPopup);\n        layer.on(\"popupclose\", onPopup);\n        feature.properties.index = `${rep.first_name} ${rep.last_name} - ${rep.district}`;\n      },\n    });\n    /*\n\n    const searchControl = new L.Control.Search({\n      layer: houseLayer,\n      propertyName: \"index\",\n      initial: false,\n      marker: false,\n      textPlaceholder: \"Search reps and districts\",\n      moveToLocation(latlng, title, map) {\n        map.fitBounds(latlng.layer.getBounds());\n        latlng.layer.openPopup();\n      },\n    });\n\n    const legendControl = L.control({ position: \"topright\" });\n    legendControl.onAdd = () => {\n      const div = L.DomUtil.create(\"div\", \"legend\");\n      div.innerHTML = districtLegend();\n      return div;\n    };\n\n    const map = L.map(\"map\")\n      .addLayer(L.tileLayer.provider(\"CartoDB.Positron\"))\n      .addLayer(houseLayer)\n      .addControl(searchControl)\n      .addControl(legendControl)\n      .fitBounds(houseLayer.getBounds());\n\n    // Avoid accidental excessive zoom out\n    map.setMinZoom(map.getZoom());\n\t\t*/\n  });\n};\n\nconst Map = () => {\n  useEffect(() => {\n    renderMap();\n  }, []);\n  return (\n    <MapContainer\n      center={[40.8054, -74.0241]}\n      zoom={14}\n      scrollWheelZoom={false}\n      style={{ height: \"50vh\", width: \"100%\" }}\n    >\n      <TileLayer\n        url={\"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png\"}\n        attribution={\n          '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, &copy; <a href=\"http://cartodb.com/attributions\">CartoDB</a>'\n        }\n      />\n      <GeoJSON\n        key={keyFunction(this.props.map.data.json)}\n        data={this.props.map.data.json}\n      />\n      <Marker position={[40.8054, -74.0241]} draggable={true} animate={true}>\n        <Popup>Hey ! I live here</Popup>\n      </Marker>\n    </MapContainer>\n  );\n};\n\nexport default Map;\n"]},"metadata":{},"sourceType":"module"}